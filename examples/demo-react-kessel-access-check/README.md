# React Kessel Access Check Demo

Interactive demo application showcasing all features of the `@project-kessel/react-kessel-access-check` package.

### *Disclaimer: This React app was generated by Claude! ðŸ¤–*

## Overview

This demo provides a simplified walkthrough of the React SDK for Kessel access control, demonstrating the core access check patterns.

## Features Demonstrated

### 1. Single Resource Check
Check if the current user has a specific permission on a single resource. Perfect for simple authorization needs like "Can I view this workspace?"

### 2. Bulk Same Relation
Check the same permission across multiple resources in a single API call. More efficient than individual checks when you need to know "Which of these 10 workspaces can I delete?"

### 3. Bulk Nested Relations
Check different permissions on one or more resources in a single request. Ideal for building permission matrices showing all available actions for a resource.

## Quick Start

```bash
# Install dependencies
npm install

# Start the development server
npm run dev
```

The app will open at `http://localhost:3000` with Mock Service Worker (MSW) intercepting API calls to simulate a real backend.

## Architecture

### Technology Stack
- **React 19** - UI framework
- **TypeScript** - Type safety
- **Vite** - Build tool and dev server
- **MSW (Mock Service Worker)** - API mocking
- **@project-kessel/react-kessel-access-check** - Kessel SDK

### Mock Data

The demo includes:
- 5 sample workspaces with varying permissions
- 3 sample documents
- Simulated network latency (800-1000ms)
- Error scenarios for testing edge cases

**Permission Matrix:**
| Workspace | View | Edit | Delete | Owner |
|-----------|------|------|--------|-------|
| Engineering Team | âœ“ | âœ“ | âœ“ | âœ“ |
| Marketing Hub | âœ“ | âœ— | âœ— | âœ— |
| Sales Dashboard | âœ“ | âœ“ | âœ— | âœ“ |
| Product Analytics | âœ— | âœ— | âœ— | âœ— |
| Customer Support | âœ“ | âœ— | âœ“ | âœ“ |

### API Endpoints (Mocked)

MSW intercepts these endpoints:
- `POST /api/kessel/v1beta2/checkself` - Single resource check
- `POST /api/kessel/v1beta2/checkselfbulk` - Bulk resource check

## Project Structure

```
src/
â”œâ”€â”€ mocks/
â”‚   â”œâ”€â”€ browser.ts          # MSW browser setup
â”‚   â”œâ”€â”€ handlers.ts         # API mock handlers
â”‚   â””â”€â”€ data.ts             # Mock data (workspaces, permissions)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ demos/
â”‚   â”‚   â”œâ”€â”€ SingleResourceCheck.tsx
â”‚   â”‚   â”œâ”€â”€ BulkSameRelation.tsx
â”‚   â”‚   â””â”€â”€ BulkNestedRelations.tsx
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ CodeBlock.tsx
â”‚   â”‚   â”œâ”€â”€ DemoSection.tsx
â”‚   â”‚   â”œâ”€â”€ PermissionBadge.tsx
â”‚   â”‚   â”œâ”€â”€ Spinner.tsx
â”‚   â”‚   â””â”€â”€ ErrorMessage.tsx
â”‚   â”œâ”€â”€ Layout.tsx
â”‚   â””â”€â”€ Navigation.tsx
â”œâ”€â”€ App.tsx                 # Main app with provider
â”œâ”€â”€ App.css                 # Styling
â””â”€â”€ main.tsx               # Entry point with MSW initialization
```

## Code Examples

### Basic Usage

```tsx
import { AccessCheck, useSelfAccessCheck } from '@project-kessel/react-kessel-access-check';

function App() {
  return (
    <AccessCheck.Provider
      baseUrl=""
      apiPath="/api/kessel/v1beta2"
    >
      <YourApp />
    </AccessCheck.Provider>
  );
}

function WorkspaceActions({ workspace }) {
  const { data, loading, error } = useSelfAccessCheck({
    relation: 'delete',
    resource: workspace
  });

  if (loading) return <Spinner />;
  if (error) return <Error message={error.message} />;

  return data?.allowed ? (
    <button>Delete Workspace</button>
  ) : null;
}
```

### Bulk Operations

```tsx
// Check same permission on multiple resources
const { data } = useSelfAccessCheck({
  relation: 'edit',
  resources: allWorkspaces
});

const editableWorkspaces = data?.filter(r => r.allowed) || [];

// Check multiple permissions on same resource
const { data } = useSelfAccessCheck({
  resources: [
    { ...workspace, relation: 'view' },
    { ...workspace, relation: 'edit' },
    { ...workspace, relation: 'delete' }
  ]
});
```

## Development

### Available Scripts

- `npm run dev` - Start development server with HMR
- `npm run build` - Build for production
- `npm run preview` - Preview production build

### Modifying Mock Data

Edit `src/mocks/data.ts` to change:
- Available workspaces and their properties
- Permission rules (who can do what)
- Error scenarios

Edit `src/mocks/handlers.ts` to change:
- API response format
- Network latency simulation
- Error conditions

## Learning Path

We recommend exploring the demos in order:

1. **Single Resource Check** - Understand the basics
2. **Bulk Same Relation** - Learn efficiency patterns
3. **Bulk Nested Relations** - Build permission matrices

## Integration with Real Backend

To connect to a real Kessel backend:

1. Remove or disable MSW initialization in `src/main.tsx`
2. Update the `baseUrl` in `App.tsx` to point to your backend
3. Ensure your backend implements the expected API endpoints
4. Configure authentication (JWT tokens in Authorization header)

Example:
```tsx
<AccessCheck.Provider
  baseUrl="https://api.your-domain.com"
  apiPath="/api/kessel/v1beta2"
>
  <App />
</AccessCheck.Provider>
```

## Resources

- **Package Documentation**: See the main package README for full API reference
- **Backend API Spec**: Required endpoints and request/response formats
- **Best Practices**: Performance optimization and caching strategies

## License

MIT
